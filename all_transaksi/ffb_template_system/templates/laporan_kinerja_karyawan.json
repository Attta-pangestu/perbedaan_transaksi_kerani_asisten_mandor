{
  "template_id": "laporan_kinerja_karyawan",
  "name": "LAPORAN KINERJA KERANI, MANDOR, DAN ASISTEN",
  "description": "Template laporan kinerja karyawan multi-estate berdasarkan analisis FFB scanner data",
  "category": "KINERJA_KARYAWAN",
  "version": "1.0.0",
  "created_by": "system",
  "created_date": "2025-10-29",
  "parameters": [
    {
      "name": "START_DATE",
      "type": "DATE",
      "display_name": "Tanggal Mulai",
      "description": "Tanggal awal periode laporan",
      "required": true,
      "ui_component": "DATE_PICKER",
      "default_value": null
    },
    {
      "name": "END_DATE",
      "type": "DATE",
      "display_name": "Tanggal Akhir",
      "description": "Tanggal akhir periode laporan",
      "required": true,
      "ui_component": "DATE_PICKER",
      "default_value": null
    },
    {
      "name": "ESTATES",
      "type": "MULTI_SELECT",
      "display_name": "Estates",
      "description": "Pilih estates yang akan dianalisis",
      "required": true,
      "ui_component": "CHECKBOX_GROUP",
      "options": [
        {"value": "PGE 1A", "label": "PGE 1A"},
        {"value": "PGE 1B", "label": "PGE 1B"},
        {"value": "PGE 2A", "label": "PGE 2A"},
        {"value": "PGE 2B", "label": "PGE 2B"},
        {"value": "IJL", "label": "IJL"},
        {"value": "DME", "label": "DME"},
        {"value": "Are B2", "label": "Are B2"},
        {"value": "Are B1", "label": "Are B1"},
        {"value": "Are A", "label": "Are A"},
        {"value": "Are C", "label": "Are C"}
      ]
    },
    {
      "name": "USE_STATUS_704_FILTER",
      "type": "BOOLEAN",
      "display_name": "Filter TRANSSTATUS 704",
      "description": "Gunakan filter khusus TRANSSTATUS 704 untuk bulan Mei",
      "required": false,
      "ui_component": "CHECKBOX",
      "default_value": false
    },
    {
      "name": "INCLUDE_ZERO_DATA",
      "type": "BOOLEAN",
      "display_name": "Sertakan Data Kosong",
      "description": "Sertakan karyawan dengan nol transaksi dalam laporan",
      "required": false,
      "ui_component": "CHECKBOX",
      "default_value": false
    }
  ],
  "sql_queries": {
    "employee_mapping": {
      "description": "Mapping employee ID to name",
      "query": "SELECT ID, NAME FROM EMP ORDER BY NAME"
    },
    "divisions": {
      "description": "Get all divisions for the period",
      "query": "SELECT DISTINCT b.DIVID, c.DIVNAME FROM FFBSCANNERDATA${MONTH} a JOIN OCFIELD b ON a.FIELDID = b.ID LEFT JOIN CRDIVISION c ON b.DIVID = c.ID WHERE b.DIVID IS NOT NULL AND c.DIVNAME IS NOT NULL AND a.TRANSDATE BETWEEN '${START_DATE}' AND '${END_DATE}'"
    },
    "main_analysis": {
      "description": "Main analysis query for FFB transaction data",
      "query": "SELECT a.ID, a.SCANUSERID, a.OCID, a.WORKERID, a.CARRIERID, a.FIELDID, a.TASKNO, a.RIPEBCH, a.UNRIPEBCH, a.BLACKBCH, a.ROTTENBCH, a.LONGSTALKBCH, a.RATDMGBCH, a.LOOSEFRUIT, a.TRANSNO, a.TRANSDATE, a.TRANSTIME, a.UPLOADDATETIME, a.RECORDTAG, a.TRANSSTATUS, a.TRANSTYPE, a.LASTUSER, a.LASTUPDATED, a.OVERRIPEBCH, a.UNDERRIPEBCH, a.ABNORMALBCH, a.LOOSEFRUIT2, b.DIVID, c.DIVNAME FROM FFBSCANNERDATA${MONTH} a JOIN OCFIELD b ON a.FIELDID = b.ID LEFT JOIN CRDIVISION c ON b.DIVID = c.ID WHERE b.DIVID = '${DIV_ID}' AND a.TRANSDATE BETWEEN '${START_DATE}' AND '${END_DATE}' ${STATUS_FILTER}"
    }
  },
  "data_processing": {
    "logic": "analisis_kinerja_karyawan",
    "steps": [
      {
        "step": 1,
        "name": "Collect Data",
        "description": "Collect all FFB transaction data for selected estates and period"
      },
      {
        "step": 2,
        "name": "Find Duplicates",
        "description": "Identify duplicate transactions by TRANSNO to determine verified transactions"
      },
      {
        "step": 3,
        "name": "Calculate Metrics",
        "description": "Calculate kerani, mandor, and asisten transaction counts and verification rates"
      },
      {
        "step": 4,
        "name": "Aggregate Results",
        "description": "Aggregate results by employee, division, and estate"
      }
    ]
  },
  "report_structure": {
    "title": "LAPORAN KINERJA KERANI, MANDOR, DAN ASISTEN",
    "subtitle": "Periode: ${START_DATE} - ${END_DATE}",
    "sections": [
      {
        "name": "summary",
        "title": "RINGKASAN EKSEKUTIF",
        "type": "summary_table",
        "data_source": "executive_summary"
      },
      {
        "name": "estate_details",
        "title": "DETAIL PER ESTATE",
        "type": "estate_tables",
        "data_source": "estate_results"
      },
      {
        "name": "employee_ranking",
        "title": "RANKING KINERJA KARYAWAN",
        "type": "ranking_table",
        "data_source": "employee_ranking"
      },
      {
        "name": "discrepancy_analysis",
        "title": "ANALISIS PERBEDAAN INPUT",
        "type": "discrepancy_table",
        "data_source": "discrepancy_details"
      }
    ]
  },
  "jasper_template": "laporan_kinerja_karyawan.jrxml",
  "output_formats": ["PDF", "EXCEL"],
  "schedule": {
    "enabled": false,
    "frequency": "monthly",
    "day_of_month": 1
  }
}